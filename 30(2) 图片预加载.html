<!doctype html>
<html lang="zh-cn">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
	<title>Document</title>
	<meta name="Keywords" content="" />
	<meta name="Description" content="" />
	<style>
		* {
			margin:0px;
			padding:0px;
		}
		ul li {
			list-style:none;
		}
		#box {
			width:930px;
			height:auto;
			overflow:hidden;
			margin:100px auto;
		}
		li {
			float:left;
			margin:0px 10px 10px 0px;
			display:inline-block;
		}
		img {
			border:none;
			display:block;
			width:300px;
			height:200px;
		}
	</style>
</head>
<body>
	<div id="box">
		<ul>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/3.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/4.jpg" src="img/loading.gif" /></li>
			<li><img data-src="img/1.jpg" src="img/loading.gif" /></li>
		</ul>
	</div>
	<script>
		window.onload = function(){
			var boxDom = document.getElementById("box"); // 获取最外层盒子
			var imgDoms = document.getElementsByTagName("img");
			showImg();//加载图片
			window.onscroll = showImg; // 滚动条滚动，图片加载
			function showImg(){
				var wHeight = window.innerHeight || document.body.clientHeight; // 获取可视区域高度  兼容写法
				var imgScrollTop = document.body.scrollTop || document.documentElement.scrollTop; // 获取滚动条滚动高度
				for(var i=0,len=imgDoms.length;i<len;i++){
					//console.log(imgDoms[i].offsetTop+"=="+imgScrollTop+"=="+wHeight);
					if(!imgDoms[i].load && getTop(imgDoms[i]) < imgScrollTop + wHeight){ // 如果图片未加载并且图片出现在可视区域
						imgDoms[i].src = imgDoms[i].getAttribute("data-src"); // 图片src改变
						imgDoms[i].load = true; 
					}
				};
			};
			
			// 获取offsetTop值的封装 ------ 不理解
			function getTop(obj){
				var top = 0;
				while(obj){
					top+=obj.offsetTop;
					obj = obj.offsetParent;
				}
				return top;
			}
		};
	</script>
</body>
</html>
